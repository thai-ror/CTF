Bài Pwn01


Mấu chốt vấn đề nằm ở đây
Để đọc được Flag thì kết quả biểu thức này phải =0

9* (
	 v14 * v15 * (v5 - 0x15F)
      + v5 * 2 * v14 * v16
      + v5 * 3 * v16 * v15
      - 0x2BE * v14 * v16
      + 7 * v5 
      - 1053 * v16 * v15
      - 2457) 
)

Vậy Phải làm cho v15,v16,v14=0,
=>Biểu thức rút gọn: 9* (7 * v5 - 2457)

Muốn cho biểu thức =0,vậy phải làm sao cho v5= 351 (2457/7)

Cách tính v5 ở hàm for này
  v5 = 0;
  for ( j = 0; j <= 4; ++j )
  {
    v9[j] = v17[j + 1];  
    v5 += v9[j];
    v9[j + 5] = abs(v13[j + 6]);
  }
  
Cho for chạy 5 vòng ==> 70*5+1 = 2457
==>v17[70,71,70,70,70,70]



Phải Ghi đè v13 sao cho:

Low Address
-----------------
|	...	|	
| v13[5]	| <- v13
| 0		| <- v14
| 0		| <- v15
| 0		| <- v16 
| 70 71 70 70   | <- v17
| 70 70 70 70   | <- v17
|     ...	|
-----------------	
High Address


Khoảng cách từ v13 đến v17  0xd4-0x70=100
=======================================
Pwn02
Ghi đè địa chỉ puts_GOT = system("/bin/cat /home/pwnd/flag")
puts_GOT=	0x804A018
system=		0x804865F


